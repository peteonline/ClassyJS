Object.create||(Object.create=function(){function t(){}return function(e){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return t.prototype=e,new t}}()),String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(void 0===this||null===this)throw new TypeError('"this" is null or not defined');var r=this.length>>>0;for(e=+e||0,1/0===Math.abs(e)&&(e=0),0>e&&(e+=r,0>e&&(e=0));r>e;e++)if(this[e]===t)return e;return-1}),function(){InvalidSyntaxFatal=function(t){this.message=t,this.stack=Error().stack},InvalidSyntaxFatal.prototype=Object.create(Error.prototype),InvalidSyntaxFatal.prototype.name="Fatal: InvalidSyntax"}(),function(){AbstractClassFatal=function(t){this.message=t,this.stack=Error().stack},AbstractClassFatal.prototype=Object.create(Error.prototype),AbstractClassFatal.prototype.name="Fatal: AbstractClass"}(),function(){AbstractMethodNotImplementedFatal=function(t){this.message=t,this.stack=Error().stack},AbstractMethodNotImplementedFatal.prototype=Object.create(Error.prototype),AbstractMethodNotImplementedFatal.prototype.name="Fatal: AbstractMethodNotImplemented"}(),function(){InvalidClassDeclarationFatal=function(t){this.message=t,this.stack=Error().stack},InvalidClassDeclarationFatal.prototype=Object.create(Error.prototype),InvalidClassDeclarationFatal.prototype.name="Fatal: InvalidClassDeclaration"}(),function(){RuntimeFatal=function(t){this.message=t,this.stack=Error().stack},RuntimeFatal.prototype=Object.create(Error.prototype),RuntimeFatal.prototype.name="Fatal: Runtime"}(),function(){ScopeFatal=function(t){this.message=t,this.stack=Error().stack},ScopeFatal.prototype=Object.create(Error.prototype),ScopeFatal.prototype.name="Fatal: Scope"}(),function(){UnknownPropertyFatal=function(t){this.message=t,this.stack=Error().stack},UnknownPropertyFatal.prototype=Object.create(Error.prototype),UnknownPropertyFatal.prototype.name="Fatal: UnknownProperty"}(),function(){UnknownMethodFatal=function(t){this.message=t,this.stack=Error().stack},UnknownMethodFatal.prototype=Object.create(Error.prototype),UnknownMethodFatal.prototype.name="Fatal: UnknownMethod"}(),function(){UnknownEventFatal=function(t){this.message=t,this.stack=Error().stack},UnknownEventFatal.prototype=Object.create(Error.prototype),UnknownEventFatal.prototype.name="Fatal: UnknownEvent"}(),function(){CannotInstantiateInterfaceFatal=function(t){this.message=t,this.stack=Error().stack},CannotInstantiateInterfaceFatal.prototype=Object.create(Error.prototype),CannotInstantiateInterfaceFatal.prototype.name="Fatal: CannotInstantiateInterface"}(),function(){InterfaceMethodNotImplementedFatal=function(t){this.message=t,this.stack=Error().stack},InterfaceMethodNotImplementedFatal.prototype=Object.create(Error.prototype),InterfaceMethodNotImplementedFatal.prototype.name="Fatal: InterfaceMethodNotImplemented"}(),function(){InterfaceIncorrectlyDefinedFatal=function(t){this.message=t,this.stack=Error().stack},InterfaceIncorrectlyDefinedFatal.prototype=Object.create(Error.prototype),InterfaceIncorrectlyDefinedFatal.prototype.name="Fatal: InterfaceIncorrectlyDefined"}(),function(){InvalidReturnTypeFatal=function(t){this.message=t,this.stack=Error().stack},InvalidReturnTypeFatal.prototype=Object.create(Error.prototype),InvalidReturnTypeFatal.prototype.name="Fatal: InvalidReturnType"}(),function(){InvalidArgumentTypeFatal=function(t){this.message=t,this.stack=Error().stack},InvalidArgumentTypeFatal.prototype=Object.create(Error.prototype),InvalidArgumentTypeFatal.prototype.name="Fatal: InvalidArgumentType"}(),function(){CloneFatal=function(t){this.message=t,this.stack=Error().stack},CloneFatal.prototype=Object.create(Error.prototype),CloneFatal.prototype.name="Fatal: Clone"}(),function(t){function e(t){if(null==t||"object"!=typeof t)return t;if(t instanceof Date){var r=new Date;return r.setTime(t.getTime()),r}if(t instanceof Array){for(var r=[],a=0,n=t.length;n>a;a++)r[a]=e(t[a]);return r}if("function"==typeof t.instanceOf&&t.instanceOf(Class)){var r=new t.type;return r.propertyValues=e(t.propertyValues),r}if(t instanceof Object){var r={};for(var s in t)t.hasOwnProperty(s)&&(r[s]=e(t[s]));return r}throw new CloneFatal("Unable to copy object argument of type "+typeof t)}function r(t){return t.child?r(t.child):t}function a(t,e,n,s,o){if(arguments.callee.caller!=a&&(n=r(n)),n.parent==s&&o.caller.parentType&&o.caller.parentType.id==n.parent.id&&(n=s),"property"==t){if(n.properties&&n.properties[e])var i=n.properties[e]}else if(n.type&&n.type.methods&&"object"==typeof n.type.methods[e])var i=n.type.methods[e];if(i)return i.value=n.propertyValues[e],i;if(n.parent){var i=a(t,e,n.parent,s,o);return"undefined"!=typeof n.propertyValues[e]&&(i.value=n.propertyValues[e]),i}throw"property"==t?new UnknownPropertyFatal(e):new UnknownMethodFatal(e)}function n(t,e){try{a("method",t,e)}catch(r){return!1}return!0}function s(t){var e=[];if("undefined"==typeof t.type)return e;for(var r in t.type.methods)t.type.methods.hasOwnProperty(r)&&e.push(r);if(t.parent){var a=s(t.parent);for(var r in a)a.hasOwnProperty(r)&&e.push(a[r])}return e}function o(t){var e=[];if(t.Extends)for(var r=t.Extends;r;){for(var a in r.staticMethods)r.staticMethods.hasOwnProperty(a)&&e.push(a);r=r.Extends||!1}return e}function i(t,e){if("[object Array]"==Object.prototype.toString.call(t)){if("["==e.substr(0,1)&&"]"==e.substr(e.length-1)){var r=e.substr(1,e.length-2);for(var a in t)if(t.hasOwnProperty(a)&&i(t[a],r)===!1)return!1}}else if("null"===e){if(null!==t)return!1}else if("object"===e){if("object"!=typeof t)return!1}else{if("object"==typeof t){if(null===t)return!1;for(var n=e.split("."),s=window,a=0;a<n.length&&"undefined"!=typeof s[n[a]];a++)s=s[n[a]];{n.pop()}return"undefined"!=typeof t.instanceOf&&t.instanceOf(s)?!0:!1}if(e!=typeof t)return!1}}function p(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function l(e){t:for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];for(var n in m)if(m.hasOwnProperty(n)&&m[n]==a)continue t;var s=a.split(".").pop(),o=a.split("/").pop()==a&&-1==["js"].indexOf(s),i=o?d:v,p=t;for(var r in i)if(i.hasOwnProperty(r)){var l=i[r].pattern;if(a.substr(0,l.length)==l){var c=i[r].target;a=a.substr(l.length);break}}o&&(a=a.split(".").join("/")+".js",s="js");var p=a;if(c&&(p=c+p),!(w.indexOf(p)>-1))switch(f(p),s){case"js":var h=document.createElement("script");h.type="text/javascript",h.src=p,h.dependencyKey=a,h.onreadystatechange=h.onload=function(){Class.registerLoadedDependency(this.getAttribute("src"))},document.getElementsByTagName("head")[0].appendChild(h),w.push(p)}}}function c(){return g.length}function f(t){g.push(t)}function h(t,e,r,a){b.push({callback:t,object:e,args:r,methodName:a})}Class=function(){};var y=0;Class.define=function(r,a){if("string"!=typeof r||""==r)throw new InvalidClassDeclarationFatal("Class name is required");if("undefined"!=typeof a&&"object"!=typeof a)throw new InvalidClassDeclarationFatal("Class definition must be object or undefined");a=a||{};var i=r.split("."),c=i.pop(),f=window;for(var h in i)i.hasOwnProperty(h)&&(f[i[h]]=f[i[h]]||{},f=f[i[h]]);var d=[];for(var h in f[c])f[c].hasOwnProperty(h)&&(d[h]=f[c][h]);f[c]=function(){if(this.type=f[c],f[c].Implements)for(var a in f[c].Implements)if(f[c].Implements.hasOwnProperty(a)){var o=f[c].Implements[a];if("string"==typeof o){for(var i=o.split("."),l=window,h=0;h<i.length;h++)l=l[i[h]];o=l}for(var u in o.methods)if(o.methods.hasOwnProperty(u)){var d=o.methods[u];if("undefined"==typeof this.type.methods[u])throw new InterfaceMethodNotImplementedFatal("Class '"+r+"' must define interface method '"+u+"'");if(this.type.methods[u].scope.level!=Class.Scope.PUBLIC)throw new InterfaceMethodNotImplementedFatal("Interface method '"+u+"' must be declared public");if(null!==d.argTypes&&!p(d.argTypes,this.type.methods[u].argTypes))throw new InvalidArgumentTypeFatal("Method '"+u+"' must match argument types of interface");if(d.returnType!==t&&d.returnType!=this.type.methods[u].returnType)throw new InvalidReturnTypeFatal("Method '"+u+"' must match return type of interface")}}this.properties=f[c].properties,this.propertyValues={};for(var a in this.properties)this.properties.hasOwnProperty(a)&&(this.properties[a].parent=this,this.propertyValues[a]=e(this.properties[a].originalValue));this.eventCallbacks={};for(var a in this.type.Events)this.type.Events.hasOwnProperty(a)&&(this.eventCallbacks[a]=[]);this.type.Extends?this.parent=new this.type.Extends:(this.parent=new Class,this.parent.type=Class,this.parent.id=y++),this.parent.child=this,this.id=this.parent.id;var v=s(this);for(var a in v)if(v.hasOwnProperty(a)){var m=v[a];"function"!=typeof this[m]&&(this[m]=function(){for(var t=[arguments.callee.methodName],e=0;e<arguments.length;e++)t.push(arguments[e]);return this.call.apply(this,t)},this[m].methodName=m)}if(arguments.callee.caller!=f[c].toString()){if(f[c].Abstract)throw new AbstractClassFatal("Abstract class cannot be instantiated");if(n("construct",this)&&arguments.callee.caller!==e){for(var g=["construct"],a=0;a<arguments.length;a++)g.push(arguments[a]);this.call.apply(this,g)}}},f[c].className=r;for(var h in d)d.hasOwnProperty(h)&&(f[c][h]=d[h]);if(f[c].prototype=Class.prototype,a.Require&&("[object Array]"!=Object.prototype.toString.apply(a.Require)&&(a.Require=[a.Require]),l(a.Require,Class.registerLoadedDependency),delete a.Require),a.Abstract){if("[object Array]"==Object.prototype.toString.apply(a.Abstract)){for(var h in a.Abstract)if(a.Abstract.hasOwnProperty(h)){var v=a.Abstract[h].split(" ");if("public"!=v[0]&&"protected"!=v[0])throw new InvalidSyntaxFatal("Abstract methods must be specified public or protected")}f[c].AbstractMethods=a.Abstract}f[c].Abstract=!0,delete a.Abstract}if(a.Extends&&(f[c].Extends=a.Extends,delete a.Extends),a.Implements&&("[object Array]"!=Object.prototype.toString.apply(a.Implements)&&(a.Implements=[a.Implements]),f[c].Implements=a.Implements,delete a.Implements),a.Events||(a.Events=[]),a.Events){if("[object Array]"!=Object.prototype.toString.apply(a.Events))throw new InvalidSyntaxFatal("Events must be declared in an array");var m={},g=!1;for(var h in a.Events)if(a.Events.hasOwnProperty(h)){if("string"!=typeof a.Events[h])throw new InvalidSyntaxFatal("Events must be declared as an array of strings");var v=a.Events[h].split(":");if(2==v.length)var w=v[1].trim().split(" ");v=v[0].trim().split(" ");var b=2==v.length?v.shift():t;"change"==v[0]&&(g=!0),m[v[0]]={argTypes:w,returnType:b}}g||(m.change={argTypes:["string","object"],returnType:t}),f[c].Events=m,delete a.Events}f[c].properties={},f[c].methods={},f[c].staticProperties={},f[c].staticMethods={};var C=new RegExp("(?:(public|private|protected) )?([A-Za-z0-9-_]* )?(getter|setter)(?: :((?: [A-Za-z0-9-_][A-Za-z0-9-_.]*)*))?");for(var h in a)if("object"==typeof a[h]){var F={};for(var I in a[h])if(a[h].hasOwnProperty(I)){var E=I.match(C);if(E){var T="getter"==E[3]?2:4,O=[E[T]?E[T].trim():t];if("function"==typeof a[h][I]?O.push(a[h][I]):a[h][I]===!0?O.push(function(t){return t}):a[h][I]===!1&&O.push(!1),"boolean"!=typeof a[h][I]&&"function"!=typeof a[h][I]&&"undefined"!=typeof a[h][I])throw new InvalidSyntaxFatal("Property getter should specify a function or boolean");delete a[h][I],"undefined"==typeof F[h]&&(F[h]={}),"undefined"==typeof F[h].getter&&(F[h].getter={"public":[t,function(t){return t}],"private":t,"protected":t}),"undefined"==typeof F[h].setter&&(F[h].setter={"public":[t,function(t){return t}],"private":t,"protected":t}),F[h][E[3]][E[1]||"public"]=O}}for(var I in F[h])F[h].hasOwnProperty(I)&&(a[h][I]=F[h][I])}t:for(var h in a)if(a.hasOwnProperty(h)){var k,P=!1,v=h.split(":").shift().trim().split(" ");if(2==h.split(":").length)var j=h.split(":").pop().trim().split(" ");var S=v.pop();if("static"==v[0]&&(P=!0,v.shift()),"object"==typeof a[h])for(var I in a[h])if(a[h].hasOwnProperty(I)){if("getter"!=I&&"setter"!=I&&"value"!=I)break;if("undefined"==typeof a[h].getter&&"undefined"==typeof a[h].setter)break;if("private:"==h.substring(0,8)||"protected:"==h.substring(0,10)||"public:"==h.substring(0,7))throw new InvalidSyntaxFatal("Cannot declare access level on properties");if("[object Array]"!=Object.prototype.toString.apply(a[h].getter))a[h].getter=[t,a[h].getter,!0,!0];else if(1==a[h].getter.length)a[h].getter=[t,a[h].getter[0],!0,!0];else if(2==a[h].getter.length){var A=a[h].getter[0];a[h].getter="boolean"==typeof A||"function"==typeof A?[t,a[h].getter[0],a[h].getter[1],a[h].getter[1]]:[a[h].getter[0],a[h].getter[1],!0,!0]}else if(3==a[h].getter.length){var A=a[h].getter[0];a[h].getter="boolean"==typeof A||"function"==typeof A?[t,a[h].getter[0],a[h].getter[1],a[h].getter[2]]:[a[h].getter[0],a[h].getter[1],a[h].getter[2],a[h].getter[2]]}if("[object Array]"!=Object.prototype.toString.apply(a[h].setter))a[h].setter=[t,a[h].setter,!0,!0];else if(1==a[h].setter.length)a[h].setter=[t,a[h].setter[0],!0,!0];else if(2==a[h].setter.length){var A=a[h].setter[0];a[h].setter="boolean"==typeof A||"function"==typeof A?[t,a[h].setter[0],a[h].setter[1],a[h].setter[1]]:[a[h].setter[0],a[h].setter[1],!0,!0]}else if(3==a[h].setter.length){var A=a[h].setter[0];a[h].setter="boolean"==typeof A||"function"==typeof A?[t,a[h].setter[0],a[h].setter[1],a[h].setter[2]]:[a[h].setter[0],a[h].setter[1],a[h].setter[2],a[h].setter[2]]}k=new Class.Scope(Class.Scope.PRIVATE),f[c].properties[S]=new Class.Property(S,a[h].value,k,"undefined"==typeof a[h].getter[1]||a[h].getter[1]===!0?function(t){return t}:a[h].getter[1],"undefined"==typeof a[h].setter[1]||a[h].setter[1]===!0?function(t){return t}:a[h].setter[1],a[h].getter[2],a[h].getter[3],a[h].setter[2],a[h].setter[3],a[h].getter[0],a[h].setter[0]),k.parent=f[c].properties[S],f[c].properties[S].originalValue=a[h].value;continue t}if("private"==v[0]?(k=new Class.Scope(Class.Scope.PRIVATE),v.shift()):"protected"==v[0]?(k=new Class.Scope(Class.Scope.PROTECTED),v.shift()):"public"==v[0]?(k=new Class.Scope(Class.Scope.PUBLIC),v.shift()):k=new Class.Scope(Class.Scope.PRIVATE),P)if("function"==typeof a[h]){f[c].staticMethods[S]=new Class.Method(S,a[h],k,!0,0==v.length?t:v[0],j);var M=f[c].staticMethods[S];k.parent=M,M.parentType=f[c],M.method.parentType=f[c],f[c][S]=function(){return u(f[c],arguments.callee.methodName,arguments)},f[c][S].methodName=S}else if("[object Array]"!=Object.prototype.toString.call(a[h])||"function"!=typeof a[h][a[h].length-1]||a[h].length!=a[h][a[h].length-1].length+2&&a[h].length!=a[h][a[h].length-1].length+1){f[c].staticProperties[S]=new Class.Property(S,a[h],k);var x=f[c].staticProperties[S];x.parentType=f[c],k.parent=f[c].staticProperties[S]}else{var M=a[h].pop();if(a[h].length==M.length+1)var b=a[h].splice(0,1)[0];f[c].staticMethods[S]=new Class.Method(S,M,k,!0,b,a[h]);var M=f[c].staticMethods[S];k.parent=M,M.parentType=f[c],M.method.parentType=f[c],f[c][S]=function(){return u(f[c],arguments.callee.methodName,arguments)},f[c][S].methodName=S}else"function"==typeof a[h]?(f[c].methods[S]=new Class.Method(S,a[h],k,null,0==v.length?t:v[0],j),k.parent=f[c].methods[S],f[c].methods[S].parentType=f[c],f[c].methods[S].method.parentType=f[c]):(f[c].properties[S]=new Class.Property(S,a[h],k),k.parent=f[c].properties[S],f[c].properties[S].originalValue=a[h])}var U=o(f[c]);for(var h in U)U.hasOwnProperty(h)&&(f[c][U[h]]=function(){return u(f[c],arguments.callee.methodName,arguments)},f[c][U[h]].methodName=U[h]);if(f[c].get=function(t){for(var e=this,r=e.staticProperties[t];!r&&e.Extends;)e=e.Extends,r=e.staticProperties[t];if(!r)throw new UnknownPropertyFatal(t);return f[c].staticProperties[t].scope.checkCallingFunction(arguments.callee.caller),f[c].staticProperties[t].value},f[c].set=function(t,e){if("undefined"==typeof f[c].staticProperties[t])throw new UnknownPropertyFatal(t);f[c].staticProperties[t].value=e},!f[c].Abstract&&f[c].Extends){for(var R=f[c].Extends,N=[],D={},V=!1;R;){for(var h in R.AbstractMethods)R.AbstractMethods.hasOwnProperty(h)&&(N.push(R.AbstractMethods[h]),V=!0);R=R.Extends||!1}for(var h in N)if(N.hasOwnProperty(h)){var v=N[h].split(":");if("undefined"!=typeof v[1])var L=v[1].trim().split(" ");else var L=[];if(v=v[0].trim().split(" "),"protected"==v[0]){var k=Class.Scope.PROTECTED;v.shift()}else if("public"==v[0]){var k=Class.Scope.PUBLIC;v.shift()}else var k=Class.Scope.PROTECTED;2==v.length&&L.unshift(v.shift());var q=v.shift();D[q]={scope:k,implemented:!1,types:L}}if(V){for(R=f[c];R;){for(var h in R.methods){var B=!1;if(R.methods.hasOwnProperty(h)&&"undefined"!=typeof D[h]){D[h].scope==R.methods[h].scope.level&&(B=!0);var z=D[h].types;if(0!=z.length){if("undefined"==typeof R.methods[h].argTypes)var Z=0;else var Z=R.methods[h].argTypes.length;if(z.length!=Z&&z.length!=Z+1&&(B=!1),z.length==Z)for(var I in z)if(z.hasOwnProperty(I)&&R.methods[h].argTypes[I]!==z[I]){B=!1;break}if(z.length==Z+1){R.methods[h].returnType!=z[0]&&(B=!1);for(var I in z)if(0!=I&&z.hasOwnProperty(I)&&R.methods[h].argTypes[parseInt(I)-1]!==z[I]){B=!1;break}}}B&&(D[h].implemented=!0)}}R=R.Extends||!1}for(var h in D)if(D.hasOwnProperty(h)&&D[h].implemented===!1)throw new AbstractMethodNotImplementedFatal(h)}}},Class.prototype.get=function(t){var e=a("property",t,this,this,arguments.callee.caller);if("object"==typeof e.getter){if(e.parent.type==this.type)if("undefined"!=typeof e.getter["private"])var r=e.getter["private"];else if("undefined"!=typeof e.getter["protected"])var r=e.getter["protected"];else var r=e.getter["public"];else if(e.parent.type!=this.type)if("undefined"!=typeof e.getter["protected"])var r=e.getter["protected"];else var r=e.getter["public"];else var r=e.getter["public"];if(r[1]===!1)throw new ScopeFatal("Cannot access restricted property");var n=r[1](e.value);if(r[0]&&i(n,r[0])===!1)throw new InvalidReturnTypeFatal;return n}return e.scope.checkCallingFunction(arguments.callee.caller),e.value},Class.prototype.set=function(t,e){var r=a("property",t,this,this,arguments.callee.caller);if("object"==typeof r.setter){if(r.parent.type==this.type)if("undefined"!=typeof r.setter["private"])var n=r.setter["private"];else if("undefined"!=typeof r.setter["protected"])var n=r.setter["protected"];else var n=r.setter["public"];else if(r.parent.type!=this.type)if("undefined"!=typeof r.setter["protected"])var n=r.setter["protected"];else var n=r.setter["public"];else var n=r.setter["public"];if(n[1]===!1)throw new ScopeFatal("Cannot access restricted property");var e=n[1](e,r.value);if(n[0]&&i(e,n[0])===!1)throw new InvalidArgumentTypeFatal;r.value=e,this.propertyValues[t]=r.value}else r.scope.checkCallingFunction(arguments.callee.caller),r.value=e,this.propertyValues[t]=r.value;if("undefined"!=typeof e&&e.instanceOf&&e.instanceOf(Class)){var s=this,o=[],p=function(e,r){for(var a=0;a<u.length;a++)if(o[a]===r)return void o.push(r);o.push(r),s.trigger("change",t,s)};p.id="set-change-callback",e.bind("change",p)}this.trigger("change",t,this)},Class.prototype.call=function(t){var e=r(this),s=!1;try{var o=a("method",t,e,this,arguments.callee.caller)}catch(p){if(!(p instanceof UnknownMethodFatal))throw p;if(!n("call",e))throw p;var o=a("method","call",e,this,arguments.callee.caller);s=!0}var l={};for(var f in o)o.hasOwnProperty(f)&&"prototype"!=f&&(l[f]=o[f]);l.method.parent=this,l.parentType.id=e.id,l.scope.checkCallingFunction(arguments.callee.caller.caller);for(var y=[],u=1;u<arguments.length;u++)y.push(arguments[u]);if("undefined"!=typeof l.argTypes)for(var d in l.argTypes)if(l.argTypes.hasOwnProperty(d)&&i(y[d],l.argTypes[d])===!1)throw new InvalidArgumentTypeFatal;if(c())return void h(l.method,e,y,t);if(s===!1)var v=l.method.apply(e,y);else var v=l.method.call(e,t,y);if("undefined"==typeof l.returnType)return v;if(i(v,l.returnType)===!1)throw new InvalidReturnTypeFatal;return v},Class.prototype.trigger=function(){var t=arguments.callee.caller;if(t!==Class.prototype.set&&"set-change-callback"!=t.id&&t.parent.type.methods.construct&&t==t.parent.type.methods.construct.method)throw new RuntimeFatal("Cannot trigger an event from a constructor");for(var e=arguments[0],a=r(this);a;){if("undefined"!=typeof a.eventCallbacks&&"undefined"!=typeof a.eventCallbacks[e]){var n=a.eventCallbacks;break}a=a.parent?a.parent:!1}if(!n)throw new UnknownEventFatal(e);for(var s=[],o=1;o<arguments.length;o++)s.push(arguments[o]);for(var o in n[e])if(n[e].hasOwnProperty(o)){var i=n[e][o];i.method.method.apply(i.object,s)}},Class.prototype.bind=function(t,e){for(var n=r(this);n;){if("undefined"!=typeof n.eventCallbacks&&"undefined"!=typeof n.eventCallbacks[t]){var s=n.eventCallbacks;break}n=n.parent?n.parent:!1}if(!s)throw new UnknownEventFatal(t);var o=r(this);if(arguments.callee.caller===Class.prototype.set)return void s.change.push({object:o,method:{method:e}});var i=arguments.callee.caller.parent,p=a("method",e,i,this,arguments.callee.caller),l={};for(property in p)p.hasOwnProperty(property)&&"prototype"!=property&&(l[property]=p[property]);if(l.method.parent=this,l.parentType.id=i.id,l.scope.checkCallingObject(o),"undefined"!=typeof l.argTypes)for(var c in n.type.Events[t].argTypes)if(n.type.Events[t].argTypes.hasOwnProperty(c)&&l.argTypes[c]!==n.type.Events[t].argTypes[c])throw new InvalidArgumentTypeFatal("Method argument types must match target event argument types");for(var c in this.eventCallbacks[t])if(this.eventCallbacks[t].hasOwnProperty(c)&&this.eventCallbacks[t][c].method.name==e&&this.eventCallbacks[t][c].object==arguments.callee.caller.parent)return;var s=s||this.eventCallbacks;s[t].push({object:i,method:p})},Class.prototype.unbind=function(t,e){for(var a=r(this);a;){if("undefined"!=typeof a.eventCallbacks&&"undefined"!=typeof a.eventCallbacks[t]){var n=a.eventCallbacks;break}a=a.parent?a.parent:!1}if(!n)throw new UnknownEventFatal(t);for(var s in n[t])if(n[t].hasOwnProperty(s)&&n[t][s].method.name==e&&n[t][s].object==arguments.callee.caller.parent)return void n[t].splice(s,1)};var u=function(e,r,a){for(var n=e.staticMethods[r];!n&&e.Extends;)e=e.Extends,n=e.staticMethods[r];if(!n)throw new UnknownMethodFatal(r);n.scope.checkCallingFunction(arguments.callee.caller.caller);for(var s=[],o=0;o<a.length;o++)s.push(a[o]);if(n.argTypes)for(var o in n.argTypes)if(n.argTypes.hasOwnProperty(o)&&i(s[o],n.argTypes[o])===!1)throw new InvalidArgumentTypeFatal;var p=n.method.apply(t,s);if(n.returnType&&i(p,n.returnType)===!1)throw new InvalidReturnTypeFatal;return p};Class.prototype.instanceOf=function(t){if(this.type===t)return!0;if(this.type&&this.type.Implements)for(var e in this.type.Implements)if(this.type.Implements.hasOwnProperty(e)&&t===this.type.Implements[e])return!0;return this.parent?this.parent.instanceOf(t):!1},Class.prototype.clone=function(){return e(this)},Class.prototype.toString=function(){return this.type&&this.type.methods&&"object"==typeof this.type.methods.toString?this.call("toString"):this.parent?this.parent.toString():"[object "+r(this).type.className+"]"},Class.prototype.proxyMethod=function(t){var e=arguments.callee.caller;return function(){t.proxyMethod=e,t.apply(e.parent,arguments)}};var d=[],v=[];Class.addClassAutoloadPattern=function(t,e){d.push({pattern:t,target:e}),d.sort(function(t,e){return e.pattern.length-t.pattern.length})},Class.addFolderAutoloadPattern=function(t,e){v.push({pattern:t,target:e}),v.sort(function(t,e){return e.pattern.length-t.pattern.length})},Class.require=function(t,e){var r=arguments.callee.caller.parent;"[object Array]"!=Object.prototype.toString.call(t)&&(t=[t]);for(var a=0;a<t.length;a++)h(r.type.methods[e].method,r,[t[a]],e);l(t)};var m=[],g=[],w=[],b=[];Class.registerLoadedDependency=function(t){for(var e=g.length;e--;)g[e]==t&&g.splice(e,1);if(0==g.length)for(var e in b)if(b.hasOwnProperty(e)){var r=b[e];delete b[e],r.callback.apply(r.object,r.args)}},Class.registerLoadedClass=function(t){"[object Array]"!=Object.prototype.toString.apply(t)&&(t=[t]);for(var e in t)t.hasOwnProperty(e)&&m.push(t[e])}}(),function(){Interface=function(){},Interface.define=function(t,e){var r={};for(var a in e)if(e.hasOwnProperty(a)){var n=e[a].split(":");if(2==n.length)var s=n.pop().trim().split(" ");else var s=null;if(n=n[0].trim().split(" "),2==n.length)var o=n.shift();n.length>1,r[n[0]]={argTypes:s,returnType:o}}var i=t.split("."),p=i.pop(),l=window;for(var a in i)i.hasOwnProperty(a)&&(l[i[a]]=l[i[a]]||{},l=l[i[a]]);l[p]=function(){throw new CannotInstantiateInterfaceFatal},l[p].methods=r}}(),function(){Class.Scope=function(t){if(t!=Class.Scope.PUBLIC&&t!=Class.Scope.PROTECTED&&t!=Class.Scope.PRIVATE)throw new InvalidSyntaxFatal("Invalid scope declaration");this.level=t},Class.Scope.PUBLIC=1,Class.Scope.PROTECTED=0,Class.Scope.PRIVATE=-1,Class.Scope.prototype.checkCallingObject=function(t){switch(this.level){case Class.Scope.PUBLIC:return!0;case Class.Scope.PROTECTED:if(t=t||{},this.parent instanceof Class.Method){if(this.parent.isStatic){for(var e=t;e;){if(e==this.parent.parentType)return!0;e=e.Extends||!1}throw new ScopeFatal("Cannot access protected method '"+this.parent.name+"'")}if(this.parent.parentType.id!=t.id)throw new ScopeFatal("Cannot access protected method '"+this.parent.name+"'")}else{if(this.parent.parentType){for(var e=t;e;){if(this.parent.parentType==e)return!0;e=e.Extends||!1}throw new ScopeFatal("Cannot access protected property '"+this.parent.name+"'")}if(this.parent.parent.id!=t.id)throw new ScopeFatal("Cannot access protected property '"+this.parent.name+"'")}break;case Class.Scope.PRIVATE:if(this.parent instanceof Class.Method){if(this.parent.parentType!=t)throw new ScopeFatal("Cannot access private method '"+this.parent.name+"'")}else{var r=this.parent.parentType?this.parent.parentType:this.parent.parent.type;if(r!=t)throw new ScopeFatal("Cannot access private property '"+this.parent.name+"'")}}},Class.Scope.prototype.checkCallingFunction=function(t){return t.proxyMethod&&(t=t.proxyMethod),this.checkCallingObject(t.parentType)}}(),function(){Class.Property=function(t,e,r,a,n,s,o,i,p,l,c){this.name=t,this.value=e,this.scope=r,this.getter=a,this.setter=n,this.ownerUsesGetter=s,this.childUsesGetter=o,this.ownerUsesSetter=i,this.childUsesSetter=p,this.getterType=l,this.setterType=c}}(),function(){Class.Method=function(t,e,r,a,n,s){this.name=t,this.method=e,this.scope=r||new Class.Scope(Class.Scope.PUBLIC),this.isStatic=a||!1,this.returnType=n,this.argTypes=s}}();