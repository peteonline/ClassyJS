Object.create||(Object.create=function(){function t(){}return function(e){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return t.prototype=e,new t}}()),String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(void 0===this||null===this)throw new TypeError('"this" is null or not defined');var r=this.length>>>0;for(e=+e||0,1/0===Math.abs(e)&&(e=0),0>e&&(e+=r,0>e&&(e=0));r>e;e++)if(this[e]===t)return e;return-1}),function(){InvalidSyntaxFatal=function(t){this.message=t,this.stack=Error().stack},InvalidSyntaxFatal.prototype=Object.create(Error.prototype),InvalidSyntaxFatal.prototype.name="Fatal: InvalidSyntax"}(),function(){AbstractClassFatal=function(t){this.message=t,this.stack=Error().stack},AbstractClassFatal.prototype=Object.create(Error.prototype),AbstractClassFatal.prototype.name="Fatal: AbstractClass"}(),function(){AbstractMethodNotImplementedFatal=function(t){this.message=t,this.stack=Error().stack},AbstractMethodNotImplementedFatal.prototype=Object.create(Error.prototype),AbstractMethodNotImplementedFatal.prototype.name="Fatal: AbstractMethodNotImplemented"}(),function(){AbstractEventNotImplementedFatal=function(t){this.message=t,this.stack=Error().stack},AbstractEventNotImplementedFatal.prototype=Object.create(Error.prototype),AbstractEventNotImplementedFatal.prototype.name="Fatal: AbstractEventNotImplemented"}(),function(){InvalidClassDeclarationFatal=function(t){this.message=t,this.stack=Error().stack},InvalidClassDeclarationFatal.prototype=Object.create(Error.prototype),InvalidClassDeclarationFatal.prototype.name="Fatal: InvalidClassDeclaration"}(),function(){RuntimeFatal=function(t){this.message=t,this.stack=Error().stack},RuntimeFatal.prototype=Object.create(Error.prototype),RuntimeFatal.prototype.name="Fatal: Runtime"}(),function(){ScopeFatal=function(t){this.message=t,this.stack=Error().stack},ScopeFatal.prototype=Object.create(Error.prototype),ScopeFatal.prototype.name="Fatal: Scope"}(),function(){UnknownPropertyFatal=function(t){this.message=t,this.stack=Error().stack},UnknownPropertyFatal.prototype=Object.create(Error.prototype),UnknownPropertyFatal.prototype.name="Fatal: UnknownProperty"}(),function(){UnknownMethodFatal=function(t){this.message=t,this.stack=Error().stack},UnknownMethodFatal.prototype=Object.create(Error.prototype),UnknownMethodFatal.prototype.name="Fatal: UnknownMethod"}(),function(){UnknownEventFatal=function(t){this.message=t,this.stack=Error().stack},UnknownEventFatal.prototype=Object.create(Error.prototype),UnknownEventFatal.prototype.name="Fatal: UnknownEvent"}(),function(){CannotInstantiateInterfaceFatal=function(t){this.message=t,this.stack=Error().stack},CannotInstantiateInterfaceFatal.prototype=Object.create(Error.prototype),CannotInstantiateInterfaceFatal.prototype.name="Fatal: CannotInstantiateInterface"}(),function(){InterfaceMethodNotImplementedFatal=function(t){this.message=t,this.stack=Error().stack},InterfaceMethodNotImplementedFatal.prototype=Object.create(Error.prototype),InterfaceMethodNotImplementedFatal.prototype.name="Fatal: InterfaceMethodNotImplemented"}(),function(){InterfaceEventNotImplementedFatal=function(t){this.message=t,this.stack=Error().stack},InterfaceEventNotImplementedFatal.prototype=Object.create(Error.prototype),InterfaceEventNotImplementedFatal.prototype.name="Fatal: InterfaceEventNotImplemented"}(),function(){InterfaceIncorrectlyDefinedFatal=function(t){this.message=t,this.stack=Error().stack},InterfaceIncorrectlyDefinedFatal.prototype=Object.create(Error.prototype),InterfaceIncorrectlyDefinedFatal.prototype.name="Fatal: InterfaceIncorrectlyDefined"}(),function(){InvalidReturnTypeFatal=function(t){this.message=t,this.stack=Error().stack},InvalidReturnTypeFatal.prototype=Object.create(Error.prototype),InvalidReturnTypeFatal.prototype.name="Fatal: InvalidReturnType"}(),function(){InvalidArgumentTypeFatal=function(t){this.message=t,this.stack=Error().stack},InvalidArgumentTypeFatal.prototype=Object.create(Error.prototype),InvalidArgumentTypeFatal.prototype.name="Fatal: InvalidArgumentType"}(),function(){CloneFatal=function(t){this.message=t,this.stack=Error().stack},CloneFatal.prototype=Object.create(Error.prototype),CloneFatal.prototype.name="Fatal: Clone"}(),function(t){function e(t){if(null==t||"object"!=typeof t)return t;if(t instanceof Date){var r=new Date;return r.setTime(t.getTime()),r}if(t instanceof Array){for(var r=[],n=0,a=t.length;a>n;n++)r[n]=e(t[n]);return r}if("function"==typeof t.instanceOf&&t.instanceOf(Class)){var r=new t.type;return r.propertyValues=e(t.propertyValues),r}if(t instanceof Object){var r={};for(var s in t)t.hasOwnProperty(s)&&(r[s]=e(t[s]));return r}throw new CloneFatal("Unable to copy object argument of type "+typeof t)}function r(t){return t.child?r(t.child):t}function n(t,e,a,s,o){if(arguments.callee.caller!=n&&(a=r(a)),a.parent==s&&o.caller.parentType&&o.caller.parentType.id==a.parent.id&&(a=s),"property"==t){if(a.properties&&a.properties[e])var i=a.properties[e]}else if(a.type&&a.type.methods&&"object"==typeof a.type.methods[e])var i=a.type.methods[e];if(i)return i.value=a.propertyValues[e],i;if(a.parent){var i=n(t,e,a.parent,s,o);return"undefined"!=typeof a.propertyValues[e]&&(i.value=a.propertyValues[e]),i}throw"property"==t?new UnknownPropertyFatal(e):new UnknownMethodFatal(e)}function a(t,e){try{n("method",t,e)}catch(r){return!1}return!0}function s(t){var e=[];if("undefined"==typeof t.type)return e;for(var r in t.type.methods)t.type.methods.hasOwnProperty(r)&&e.push(r);if(t.parent){var n=s(t.parent);for(var r in n)n.hasOwnProperty(r)&&e.push(n[r])}return e}function o(t){var e=[];if(t.Extends)for(var r=t.Extends;r;){for(var n in r.staticMethods)r.staticMethods.hasOwnProperty(n)&&e.push(n);r=r.Extends||!1}return e}function i(t,e){if("function"==typeof window[e]&&t instanceof window[e])return!0;if("[object Array]"==Object.prototype.toString.call(t)){if("["==e.substr(0,1)&&"]"==e.substr(e.length-1)){var r=e.substr(1,e.length-2);for(var n in t)if(t.hasOwnProperty(n)&&i(t[n],r)===!1)return!1}}else if("null"===e){if(null!==t)return!1}else if("object"===e){if("object"!=typeof t)return!1}else{if("object"==typeof t){if(null===t)return!1;for(var a=e.split("."),s=window,n=0;n<a.length&&"undefined"!=typeof s[a[n]];n++)s=s[a[n]];{a.pop()}return"undefined"!=typeof t.instanceOf&&t.instanceOf(s)?!0:!1}if(e!=typeof t)return!1}}function p(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function l(e){t:for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];for(var a in v)if(v.hasOwnProperty(a)&&v[a]==n){Class.registerLoadedDependency();continue t}var s=n.split(".").pop(),o=n.split("/").pop()==n&&-1==["js"].indexOf(s),i=o?u:d,p=t;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a].pattern;if(n.substr(0,l.length)==l){var f=i[a].target;n=n.substr(l.length);break}}o&&(n=n.split(".").join("/")+".js",s="js");var p=n;if(f&&(p=f+p),!(g.indexOf(p)>-1))switch(c(p),s){case"js":var h=document.createElement("script");h.type="text/javascript",h.src=p,h.dependencyClass=o?e[r]:t,h.onreadystatechange=h.onload=function(){Class.registerLoadedDependency(this.getAttribute("src")),this.dependencyClass&&Class.registerLoadedClass(this.dependencyClass)},document.getElementsByTagName("head")[0].appendChild(h),g.push(p)}}}function c(t){m.push(t)}function f(t,e,r,n){w.push({callback:t,object:e,args:r,methodName:n})}Class=function(){};var h=0;Class.define=function(r,n){if("string"!=typeof r||""==r)throw new InvalidClassDeclarationFatal("Class name is required");if("undefined"!=typeof n&&"object"!=typeof n)throw new InvalidClassDeclarationFatal("Class definition must be object or undefined");n=n||{};var i=r.split("."),c=i.pop(),f=window;for(var u in i)i.hasOwnProperty(u)&&(f[i[u]]=f[i[u]]||{},f=f[i[u]]);var d=[];for(var u in f[c])f[c].hasOwnProperty(u)&&(d[u]=f[c][u]);f[c]=function(){if(this.type=f[c],f[c].Implements)for(var n in f[c].Implements)if(f[c].Implements.hasOwnProperty(n)){var o=f[c].Implements[n];if("string"==typeof o){for(var i=o.split("."),l=window,y=0;y<i.length;y++)l=l[i[y]];o=l}for(var u in o.methods)if(o.methods.hasOwnProperty(u)){var d=o.methods[u];if(d.isEvent){if("undefined"==typeof this.type.Events[u])throw new InterfaceEventNotImplementedFatal("Class '"+r+"' must define interface event '"+u+"'")}else if("undefined"==typeof this.type.methods[u])throw new InterfaceMethodNotImplementedFatal("Class '"+r+"' must define interface method '"+u+"'");if(!d.isEvent&&this.type.methods[u].scope.level!=Class.Scope.PUBLIC)throw new InterfaceMethodNotImplementedFatal("Interface method '"+u+"' must be declared public");if(d.isEvent){if(null!==d.argTypes&&!p(d.argTypes,this.type.Events[u].argTypes))throw new InvalidArgumentTypeFatal("Event '"+u+"' must match argument types of interface");if(d.returnType!==t&&d.returnType!=this.type.Events[u].returnType)throw new InvalidReturnTypeFatal("Event '"+u+"' must match return type of interface")}else{if(null!==d.argTypes&&!p(d.argTypes,this.type.methods[u].argTypes))throw new InvalidArgumentTypeFatal("Method '"+u+"' must match argument types of interface");if(d.returnType!==t&&d.returnType!=this.type.methods[u].returnType)throw new InvalidReturnTypeFatal("Method '"+u+"' must match return type of interface")}}}this.properties=f[c].properties,this.propertyValues={};for(var n in this.properties)this.properties.hasOwnProperty(n)&&(this.properties[n].parent=this,this.propertyValues[n]=e(this.properties[n].originalValue));this.eventCallbacks={};for(var n in this.type.Events)this.type.Events.hasOwnProperty(n)&&(this.eventCallbacks[n]=[]);if(this.type.Extends){if("object"==typeof this.type.Extends)for(var v=this.type.ExtendsClassName.split("."),m=window,n=0;n<v.length;n++)n==v.length-1&&(this.type.Extends=m[v[n]]),m=m[v[n]];this.parent=new this.type.Extends}else this.parent=new Class,this.parent.type=Class,this.parent.id=h++;this.parent.child=this,this.id=this.parent.id;var g=s(this);for(var n in g)if(g.hasOwnProperty(n)){var w=g[n];"function"!=typeof this[w]&&(this[w]=function(){for(var t=[arguments.callee.methodName],e=0;e<arguments.length;e++)t.push(arguments[e]);return this.call.apply(this,t)},this[w].methodName=w)}if(arguments.callee.caller!=f[c].toString()){if(f[c].Abstract)throw new AbstractClassFatal("Abstract class cannot be instantiated");if(a("construct",this)&&arguments.callee.caller!==e){for(var b=["construct"],n=0;n<arguments.length;n++)b.push(arguments[n]);this.call.apply(this,b)}}},f[c].className=r;for(var u in d)d.hasOwnProperty(u)&&(f[c][u]=d[u]);if(f[c].prototype=Class.prototype,n.Require&&("[object Array]"!=Object.prototype.toString.apply(n.Require)&&(n.Require=[n.Require]),l(n.Require,Class.registerLoadedDependency),delete n.Require),n.Abstract){if("[object Array]"==Object.prototype.toString.apply(n.Abstract)){var v=[];for(var u in n.Abstract)if(n.Abstract.hasOwnProperty(u)){if("event "==n.Abstract[u].substr(0,6)){var m=!0;n.Abstract[u]=n.Abstract[u].substr(6)}var g=n.Abstract[u].split(" ");if(m)v.push(n.Abstract[u]),delete n.Abstract[u];else if("public"!=g[0]&&"protected"!=g[0])throw new InvalidSyntaxFatal("Abstract methods must be specified public or protected")}f[c].AbstractMethods=n.Abstract,f[c].AbstractEvents=v}f[c].Abstract=!0,delete n.Abstract}if(n.Extends){if("string"==typeof n.Extends){f[c].ExtendsClassName=n.Extends;for(var w=n.Extends.split("."),b=window,u=0;u<w.length;u++)u==w.length-1&&(n.Extends=b[w[u]]),b=b[w[u]]}f[c].Extends=n.Extends,delete n.Extends}if(n.Implements&&("[object Array]"!=Object.prototype.toString.apply(n.Implements)&&(n.Implements=[n.Implements]),f[c].Implements=n.Implements,delete n.Implements),n.Events||(n.Events=[]),n.Events){if("[object Array]"!=Object.prototype.toString.apply(n.Events))throw new InvalidSyntaxFatal("Events must be declared in an array");var C={},E=!1;for(var u in n.Events)if(n.Events.hasOwnProperty(u)){if("string"!=typeof n.Events[u])throw new InvalidSyntaxFatal("Events must be declared as an array of strings");var g=n.Events[u].split(":");if(2==g.length)var F=g[1].trim().split(" ");g=g[0].trim().split(" ");var I=2==g.length?g.shift():t;"change"==g[0]&&(E=!0),C[g[0]]={argTypes:F,returnType:I}}E||(C.change={argTypes:["string","object"],returnType:t}),f[c].Events=C,delete n.Events}f[c].properties={},f[c].methods={},f[c].staticProperties={},f[c].staticMethods={};var T=new RegExp("(?:(public|private|protected) )?([A-Za-z0-9-_]* )?(getter|setter)(?: :((?: [A-Za-z0-9-_][A-Za-z0-9-_.]*)*))?");for(var u in n)if("object"==typeof n[u]){var O={};for(var k in n[u])if(n[u].hasOwnProperty(k)){var P=k.match(T);if(P){var A="getter"==P[3]?2:4,j=[P[A]?P[A].trim():t];if("function"==typeof n[u][k]?j.push(n[u][k]):n[u][k]===!0?j.push(function(t){return t}):n[u][k]===!1&&j.push(!1),"boolean"!=typeof n[u][k]&&"function"!=typeof n[u][k]&&"undefined"!=typeof n[u][k])throw new InvalidSyntaxFatal("Property getter should specify a function or boolean");delete n[u][k],"undefined"==typeof O[u]&&(O[u]={}),"undefined"==typeof O[u].getter&&(O[u].getter={"public":[t,function(t){return t}],"private":t,"protected":t}),"undefined"==typeof O[u].setter&&(O[u].setter={"public":[t,function(t){return t}],"private":t,"protected":t}),O[u][P[3]][P[1]||"public"]=j}}for(var k in O[u])O[u].hasOwnProperty(k)&&(n[u][k]=O[u][k])}t:for(var u in n)if(n.hasOwnProperty(u)){var S,x=!1,g=u.split(":").shift().trim().split(" ");if(2==u.split(":").length)var M=u.split(":").pop().trim().split(" ");var N=g.pop();if("static"==g[0]&&(x=!0,g.shift()),"object"==typeof n[u])for(var k in n[u])if(n[u].hasOwnProperty(k)){if("getter"!=k&&"setter"!=k&&"value"!=k)break;if("undefined"==typeof n[u].getter&&"undefined"==typeof n[u].setter)break;if("private:"==u.substring(0,8)||"protected:"==u.substring(0,10)||"public:"==u.substring(0,7))throw new InvalidSyntaxFatal("Cannot declare access level on properties");if("[object Array]"!=Object.prototype.toString.apply(n[u].getter))n[u].getter=[t,n[u].getter,!0,!0];else if(1==n[u].getter.length)n[u].getter=[t,n[u].getter[0],!0,!0];else if(2==n[u].getter.length){var R=n[u].getter[0];n[u].getter="boolean"==typeof R||"function"==typeof R?[t,n[u].getter[0],n[u].getter[1],n[u].getter[1]]:[n[u].getter[0],n[u].getter[1],!0,!0]}else if(3==n[u].getter.length){var R=n[u].getter[0];n[u].getter="boolean"==typeof R||"function"==typeof R?[t,n[u].getter[0],n[u].getter[1],n[u].getter[2]]:[n[u].getter[0],n[u].getter[1],n[u].getter[2],n[u].getter[2]]}if("[object Array]"!=Object.prototype.toString.apply(n[u].setter))n[u].setter=[t,n[u].setter,!0,!0];else if(1==n[u].setter.length)n[u].setter=[t,n[u].setter[0],!0,!0];else if(2==n[u].setter.length){var R=n[u].setter[0];n[u].setter="boolean"==typeof R||"function"==typeof R?[t,n[u].setter[0],n[u].setter[1],n[u].setter[1]]:[n[u].setter[0],n[u].setter[1],!0,!0]}else if(3==n[u].setter.length){var R=n[u].setter[0];n[u].setter="boolean"==typeof R||"function"==typeof R?[t,n[u].setter[0],n[u].setter[1],n[u].setter[2]]:[n[u].setter[0],n[u].setter[1],n[u].setter[2],n[u].setter[2]]}S=new Class.Scope(Class.Scope.PRIVATE),f[c].properties[N]=new Class.Property(N,n[u].value,S,"undefined"==typeof n[u].getter[1]||n[u].getter[1]===!0?function(t){return t}:n[u].getter[1],"undefined"==typeof n[u].setter[1]||n[u].setter[1]===!0?function(t){return t}:n[u].setter[1],n[u].getter[2],n[u].getter[3],n[u].setter[2],n[u].setter[3],n[u].getter[0],n[u].setter[0]),S.parent=f[c].properties[N],f[c].properties[N].originalValue=n[u].value;continue t}if("private"==g[0]?(S=new Class.Scope(Class.Scope.PRIVATE),g.shift()):"protected"==g[0]?(S=new Class.Scope(Class.Scope.PROTECTED),g.shift()):"public"==g[0]?(S=new Class.Scope(Class.Scope.PUBLIC),g.shift()):S=new Class.Scope(Class.Scope.PRIVATE),x)if("function"==typeof n[u]){f[c].staticMethods[N]=new Class.Method(N,n[u],S,!0,0==g.length?t:g[0],M);var U=f[c].staticMethods[N];S.parent=U,U.parentType=f[c],U.method.parentType=f[c],f[c][N]=function(){return y(f[c],arguments.callee.methodName,arguments)},f[c][N].methodName=N}else if("[object Array]"!=Object.prototype.toString.call(n[u])||"function"!=typeof n[u][n[u].length-1]||n[u].length!=n[u][n[u].length-1].length+2&&n[u].length!=n[u][n[u].length-1].length+1){f[c].staticProperties[N]=new Class.Property(N,n[u],S);var D=f[c].staticProperties[N];D.parentType=f[c],S.parent=f[c].staticProperties[N]}else{var U=n[u].pop();if(n[u].length==U.length+1)var I=n[u].splice(0,1)[0];f[c].staticMethods[N]=new Class.Method(N,U,S,!0,I,n[u]);var U=f[c].staticMethods[N];S.parent=U,U.parentType=f[c],U.method.parentType=f[c],f[c][N]=function(){return y(f[c],arguments.callee.methodName,arguments)},f[c][N].methodName=N}else"function"==typeof n[u]?(f[c].methods[N]=new Class.Method(N,n[u],S,null,0==g.length?t:g[0],M),S.parent=f[c].methods[N],f[c].methods[N].parentType=f[c],f[c].methods[N].method.parentType=f[c]):(f[c].properties[N]=new Class.Property(N,n[u],S),S.parent=f[c].properties[N],f[c].properties[N].originalValue=n[u])}var V=o(f[c]);for(var u in V)V.hasOwnProperty(u)&&(f[c][V[u]]=function(){return y(f[c],arguments.callee.methodName,arguments)},f[c][V[u]].methodName=V[u]);if(f[c].get=function(t){for(var e=this,r=e.staticProperties[t];!r&&e.Extends;)e=e.Extends,r=e.staticProperties[t];if(!r)throw new UnknownPropertyFatal(t);return f[c].staticProperties[t].scope.checkCallingFunction(arguments.callee.caller),f[c].staticProperties[t].value},f[c].set=function(t,e){if("undefined"==typeof f[c].staticProperties[t])throw new UnknownPropertyFatal(t);f[c].staticProperties[t].value=e},!f[c].Abstract&&f[c].Extends){for(var L=f[c].Extends,q=[],B=[],z={},Z={},_=!1,G=!1;L;){for(var u in L.AbstractMethods)L.AbstractMethods.hasOwnProperty(u)&&(q.push(L.AbstractMethods[u]),_=!0);for(var u in L.AbstractEvents)L.AbstractEvents.hasOwnProperty(u)&&(B.push(L.AbstractEvents[u]),G=!0);L=L.Extends||!1}for(var u in q)if(q.hasOwnProperty(u)){var g=q[u].split(":");if("undefined"!=typeof g[1])var $=g[1].trim().split(" ");else var $=[];if(g=g[0].trim().split(" "),"protected"==g[0]){var S=Class.Scope.PROTECTED;g.shift()}else if("public"==g[0]){var S=Class.Scope.PUBLIC;g.shift()}else var S=Class.Scope.PROTECTED;2==g.length&&$.unshift(g.shift());var H=g.shift();z[H]={scope:S,implemented:!1,types:$}}for(var u in B)if(B.hasOwnProperty(u)){var g=B[u].split(":");if("undefined"!=typeof g[1])var $=g[1].trim().split(" ");else var $=[];g=g[0].trim().split(" "),2==g.length&&$.unshift(g.shift());var J=g.shift();Z[J]={implemented:!1,types:$}}if(_){for(L=f[c];L;){for(var u in L.methods){var K=!1;if(L.methods.hasOwnProperty(u)&&"undefined"!=typeof z[u]){z[u].scope==L.methods[u].scope.level&&(K=!0);var Q=z[u].types;if(0!=Q.length){if("undefined"==typeof L.methods[u].argTypes)var W=0;else var W=L.methods[u].argTypes.length;if(Q.length!=W&&Q.length!=W+1&&(K=!1),Q.length==W)for(var k in Q)if(Q.hasOwnProperty(k)&&L.methods[u].argTypes[k]!==Q[k]){K=!1;break}if(Q.length==W+1){L.methods[u].returnType!=Q[0]&&(K=!1);for(var k in Q)if(0!=k&&Q.hasOwnProperty(k)&&L.methods[u].argTypes[parseInt(k)-1]!==Q[k]){K=!1;break}}}K&&(z[u].implemented=!0)}}L=L.Extends||!1}for(var u in z)if(z.hasOwnProperty(u)&&z[u].implemented===!1)throw new AbstractMethodNotImplementedFatal(u)}if(G){for(L=f[c];L;){for(var u in L.Events){var X=!1;if(L.Events.hasOwnProperty(u)&&"undefined"!=typeof Z[u]){{Z[u].types}X=!0,"undefined"==typeof L.Events[u].argTypes&&(L.Events[u].argTypes=[]);for(var k in Z[u].types)L.Events[u].argTypes[k]!=Z[u].types[k]&&(X=!1);X&&(Z[u].implemented=!0)}}L=L.Extends||!1}for(var u in Z)if(Z.hasOwnProperty(u)&&Z[u].implemented===!1)throw new AbstractEventNotImplementedFatal(u)}}},Class.prototype.get=function(t){var e=n("property",t,this,this,arguments.callee.caller);if("object"==typeof e.getter){if(e.parent.type==this.type)if("undefined"!=typeof e.getter["private"])var r=e.getter["private"];else if("undefined"!=typeof e.getter["protected"])var r=e.getter["protected"];else var r=e.getter["public"];else if(e.parent.type!=this.type)if("undefined"!=typeof e.getter["protected"])var r=e.getter["protected"];else var r=e.getter["public"];else var r=e.getter["public"];if(r[1]===!1)throw new ScopeFatal("Cannot access restricted property");var a=r[1](e.value);if(r[0]&&i(a,r[0])===!1)throw new InvalidReturnTypeFatal;return a}return e.scope.checkCallingFunction(arguments.callee.caller),e.value},Class.prototype.set=function(t,e){var r=n("property",t,this,this,arguments.callee.caller);if("object"==typeof r.setter){if(r.parent.type==this.type)if("undefined"!=typeof r.setter["private"])var a=r.setter["private"];else if("undefined"!=typeof r.setter["protected"])var a=r.setter["protected"];else var a=r.setter["public"];else if(r.parent.type!=this.type)if("undefined"!=typeof r.setter["protected"])var a=r.setter["protected"];else var a=r.setter["public"];else var a=r.setter["public"];if(a[1]===!1)throw new ScopeFatal("Cannot access restricted property");var e=a[1](e,r.value);if(a[0]&&i(e,a[0])===!1)throw new InvalidArgumentTypeFatal;r.value=e,this.propertyValues[t]=r.value}else r.scope.checkCallingFunction(arguments.callee.caller),r.value=e,this.propertyValues[t]=r.value;if("undefined"!=typeof e&&e.instanceOf&&e.instanceOf(Class)&&e.bind){var s=this,o=[],p=function(e,r){for(var n=0;n<y.length;n++)if(o[n]===r)return void o.push(r);o.push(r),s.trigger("change",t,s)};p.id="set-change-callback",e.bind("change",p)}this.trigger("change",t,this)},Class.prototype.call=function(t){var e=r(this),s=!1;try{var o=n("method",t,e,this,arguments.callee.caller)}catch(p){if(!(p instanceof UnknownMethodFatal))throw p;if(!a("call",e))throw p;var o=n("method","call",e,this,arguments.callee.caller);s=!0}var l={};for(var c in o)o.hasOwnProperty(c)&&"prototype"!=c&&(l[c]=o[c]);l.method.parent=this,l.parentType.id=e.id,l.scope.checkCallingFunction(arguments.callee.caller.caller);for(var h=[],y=1;y<arguments.length;y++)h.push(arguments[y]);if("undefined"!=typeof l.argTypes)for(var u in l.argTypes)if(l.argTypes.hasOwnProperty(u)&&i(h[u],l.argTypes[u])===!1)throw new InvalidArgumentTypeFatal;if("construct"==t&&Class.isLoadingDependencies())return void f(l.method,e,h,t);if(s===!1)var d=l.method.apply(e,h);else var d=l.method.call(e,t,h);if("undefined"==typeof l.returnType)return d;if(i(d,l.returnType)===!1)throw new InvalidReturnTypeFatal;return d},Class.prototype.trigger=function(){var t=arguments.callee.caller;if(t!==Class.prototype.set&&"set-change-callback"!=t.id&&t.parent.type.methods.construct&&t==t.parent.type.methods.construct.method)throw new RuntimeFatal("Cannot trigger an event from a constructor");for(var e=arguments[0],n=r(this);n;){if("undefined"!=typeof n.eventCallbacks&&"undefined"!=typeof n.eventCallbacks[e]){var a=n.eventCallbacks;break}n=n.parent?n.parent:!1}if(!a)throw new UnknownEventFatal(e);for(var s=[],o=1;o<arguments.length;o++)s.push(arguments[o]);for(var o in a[e])if(a[e].hasOwnProperty(o)){var i=a[e][o];i.method.method.apply(i.object,s)}},Class.prototype.bind=function(t,e){for(var a=r(this);a;){if("undefined"!=typeof a.eventCallbacks&&"undefined"!=typeof a.eventCallbacks[t]){var s=a.eventCallbacks;break}a=a.parent?a.parent:!1}if(!s)throw new UnknownEventFatal(t);var o=r(this);if(arguments.callee.caller===Class.prototype.set)return void s.change.push({object:o,method:{method:e}});var i=arguments.callee.caller.parent,p=n("method",e,i,this,arguments.callee.caller),l={};for(property in p)p.hasOwnProperty(property)&&"prototype"!=property&&(l[property]=p[property]);if(l.method.parent=this,l.parentType.id=i.id,l.scope.checkCallingObject(o),"undefined"!=typeof l.argTypes)for(var c in a.type.Events[t].argTypes)if(a.type.Events[t].argTypes.hasOwnProperty(c)&&l.argTypes[c]!==a.type.Events[t].argTypes[c])throw new InvalidArgumentTypeFatal("Method argument types must match target event argument types");for(var c in this.eventCallbacks[t])if(this.eventCallbacks[t].hasOwnProperty(c)&&this.eventCallbacks[t][c].method.name==e&&this.eventCallbacks[t][c].object==arguments.callee.caller.parent)return;var s=s||this.eventCallbacks;s[t].push({object:i,method:p})},Class.prototype.unbind=function(t,e){for(var n=r(this);n;){if("undefined"!=typeof n.eventCallbacks&&"undefined"!=typeof n.eventCallbacks[t]){var a=n.eventCallbacks;break}n=n.parent?n.parent:!1}if(!a)throw new UnknownEventFatal(t);for(var s in a[t])if(a[t].hasOwnProperty(s)&&a[t][s].method.name==e&&a[t][s].object==arguments.callee.caller.parent)return void a[t].splice(s,1)};var y=function(e,r,n){for(var a=e.staticMethods[r];!a&&e.Extends;)e=e.Extends,a=e.staticMethods[r];if(!a)throw new UnknownMethodFatal(r);a.scope.checkCallingFunction(arguments.callee.caller.caller);for(var s=[],o=0;o<n.length;o++)s.push(n[o]);if(a.argTypes)for(var o in a.argTypes)if(a.argTypes.hasOwnProperty(o)&&i(s[o],a.argTypes[o])===!1)throw new InvalidArgumentTypeFatal;var p=a.method.apply(t,s);if(a.returnType&&i(p,a.returnType)===!1)throw new InvalidReturnTypeFatal;return p};Class.prototype.instanceOf=function(t){if(this.type===t)return!0;if(this.type&&this.type.Implements)for(var e in this.type.Implements)if(this.type.Implements.hasOwnProperty(e)&&t===this.type.Implements[e])return!0;return this.parent?this.parent.instanceOf(t):!1},Class.prototype.clone=function(){return e(this)},Class.prototype.toString=function(){return this.type&&this.type.methods&&"object"==typeof this.type.methods.toString?this.call("toString"):this.parent?this.parent.toString():"[object "+r(this).type.className+"]"},Class.prototype.proxyMethod=function(t){var e=arguments.callee.caller;return function(r){return function(){t.proxyMethod=e,t.apply(r,arguments)}}(e.parent)};var u=[],d=[];Class.addClassAutoloadPattern=function(t,e){u.push({pattern:t,target:e}),u.sort(function(t,e){return e.pattern.length-t.pattern.length})},Class.addFolderAutoloadPattern=function(t,e){d.push({pattern:t,target:e}),d.sort(function(t,e){return e.pattern.length-t.pattern.length})},Class.require=function(t,e){var r=arguments.callee.caller.parent;"[object Array]"!=Object.prototype.toString.call(t)&&(t=[t]);for(var n=0;n<t.length;n++)f(r.type.methods[e].method,r,[t[n]],e);l(t)};var v=[],m=[],g=[],w=[];Class.isLoadingDependencies=function(){return m.length},Class.registerLoadedDependency=function(t){for(var e=m.length;e--;)m[e]==t&&m.splice(e,1);if(0==m.length)for(var e in w)if(w.hasOwnProperty(e)){var r=w[e];delete w[e],r.callback.apply(r.object,r.args)}},Class.registerLoadedClass=function(t){"[object Array]"!=Object.prototype.toString.apply(t)&&(t=[t]);for(var e in t)t.hasOwnProperty(e)&&v.push(t[e])}}(),function(){Interface=function(){},Interface.define=function(t,e){var r={};for(var n in e)if(e.hasOwnProperty(n)){if("event "==e[n].substr(0,6)){var a=!0;e[n]=e[n].substr(6)}var s=e[n].split(":");if(2==s.length)var o=s.pop().trim().split(" ");else var o=null;if(s=s[0].trim().split(" "),2==s.length)var i=s.shift();s.length>1,r[s[0]]={argTypes:o,returnType:i,isEvent:a?!0:!1}}var p=t.split("."),l=p.pop(),c=window;for(var n in p)p.hasOwnProperty(n)&&(c[p[n]]=c[p[n]]||{},c=c[p[n]]);c[l]=function(){throw new CannotInstantiateInterfaceFatal},c[l].methods=r}}(),function(){Class.Scope=function(t){if(t!=Class.Scope.PUBLIC&&t!=Class.Scope.PROTECTED&&t!=Class.Scope.PRIVATE)throw new InvalidSyntaxFatal("Invalid scope declaration");this.level=t},Class.Scope.PUBLIC=1,Class.Scope.PROTECTED=0,Class.Scope.PRIVATE=-1,Class.Scope.prototype.checkCallingObject=function(t){switch(this.level){case Class.Scope.PUBLIC:return!0;case Class.Scope.PROTECTED:if(t=t||{},this.parent instanceof Class.Method){if(this.parent.isStatic){for(var e=t;e;){if(e==this.parent.parentType)return!0;e=e.Extends||!1}throw new ScopeFatal("Cannot access protected method '"+this.parent.name+"'")}if(this.parent.parentType.id!=t.id)throw new ScopeFatal("Cannot access protected method '"+this.parent.name+"'")}else{if(this.parent.parentType){for(var e=t;e;){if(this.parent.parentType==e)return!0;e=e.Extends||!1}throw new ScopeFatal("Cannot access protected property '"+this.parent.name+"'")}if(this.parent.parent.id!=t.id)throw new ScopeFatal("Cannot access protected property '"+this.parent.name+"'")}break;case Class.Scope.PRIVATE:if(this.parent instanceof Class.Method){if(this.parent.parentType!=t)throw new ScopeFatal("Cannot access private method '"+this.parent.name+"'")}else{var r=this.parent.parentType?this.parent.parentType:this.parent.parent.type;if(r!=t)throw new ScopeFatal("Cannot access private property '"+this.parent.name+"'")}}},Class.Scope.prototype.checkCallingFunction=function(t){return t.proxyMethod&&(t=t.proxyMethod),this.checkCallingObject(t.parentType)}}(),function(){Class.Property=function(t,e,r,n,a,s,o,i,p,l,c){this.name=t,this.value=e,this.scope=r,this.getter=n,this.setter=a,this.ownerUsesGetter=s,this.childUsesGetter=o,this.ownerUsesSetter=i,this.childUsesSetter=p,this.getterType=l,this.setterType=c}}(),function(){Class.Method=function(t,e,r,n,a,s){this.name=t,this.method=e,this.scope=r||new Class.Scope(Class.Scope.PUBLIC),this.isStatic=n||!1,this.returnType=a,this.argTypes=s}}();